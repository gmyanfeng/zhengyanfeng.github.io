<html>
  <head>
    <meta charset="utf-8" />
<meta name="description" content="" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Macæ­å»ºnginx+rtmpæœåŠ¡å™¨ | Fat Panda</title>
<link rel="shortcut icon" href="https://zhengyanfeng.github.io/favicon.ico?v=1583326315713">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://zhengyanfeng.github.io/styles/main.css">

<script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.23.0/moment.min.js"></script>



  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://zhengyanfeng.github.io">
  <img class="avatar" src="https://zhengyanfeng.github.io/images/avatar.png?v=1583326315713" alt="">
  </a>
  <h1 class="site-title">
    Fat Panda
  </h1>
  <p class="site-description">
    å­¦è€Œæ—¶ä¹ ä¹‹
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          é¦–é¡µ
        </a>
      
    
      
        <a href="/archives" class="menu">
          å½’æ¡£
        </a>
      
    
      
        <a href="/tags" class="menu">
          æ ‡ç­¾
        </a>
      
    
      
        <a href="/post/about" class="menu">
          å…³äº
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/zhengyanfeng" target="_blank">
          <i class="fab fa-github"></i>
        </a>
      
    
      
        <a href="https://twitter.com/awesomeyanfeng" target="_blank">
          <i class="fab fa-twitter"></i>
        </a>
      
    
      
        <a href="https://www.weibo.com/2309146301/profile?is_hot=1" target="_blank">
          <i class="fab fa-weibo"></i>
        </a>
      
    
      
    
      
    
  </div>
</div>


        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Macæ­å»ºnginx+rtmpæœåŠ¡å™¨
            </h2>
            <div class="post-info">
              <time class="post-time">
                Â· 2019-07-17 Â·
              </time>
              
                <a href="https://zhengyanfeng.github.io/tag/8kgtmp6F6R/" class="post-tag">
                  # mac rtmp
                </a>
              
            </div>
            
            <div class="post-content">
              <h2 id="å®‰è£…homebrew">å®‰è£…Homebrew</h2>
<h3 id="1æ£€æŸ¥ä½ çš„macæ˜¯å¦å·²ç»å®‰è£…äº†homebrew">1.æ£€æŸ¥ä½ çš„Macæ˜¯å¦å·²ç»å®‰è£…äº†Homebrew</h3>
<p>æ‰“å¼€ç»ˆç«¯, æŸ¥çœ‹æ˜¯å¦å·²ç»å®‰è£…äº†Homebrew, ç›´æ¥ç»ˆç«¯è¾“å…¥å‘½ä»¤</p>
<pre><code>man brew 
</code></pre>
<p>å¦‚æœMacå·²ç»å®‰è£…äº†ï¼Œç»ˆç«¯ä¼šæ˜¾ç¤ºä¸€äº›å‘½ä»¤çš„æç¤ºä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾ã€‚æ­¤æ—¶å¯ä»¥è¾“å…¥qé€€å‡ºï¼Œå¦åˆ™å°±å®‰è£…Homebrewã€‚</p>
<!-- more --> 
<figure data-type="image" tabindex="1"><img src="http://ww4.sinaimg.cn/large/65e4f1e6gw1f7fmgs6m3cj20il0d50u8.jpg" alt="check brew install" loading="lazy"></figure>
<h3 id="2å®‰è£…homebrew">2.å®‰è£…Homebrew</h3>
<p>åœ¨ç»ˆç«¯è¾“å…¥ï¼š</p>
<pre><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;
</code></pre>
<p>ä»¥é˜²å‘½ä»¤æœ‰æ‰€æ›´æ”¹å»ºè®®å»<a href="http://brew.sh/">Homebrewå®˜ç½‘</a>ï¼ˆä¸è¿‡æˆ‘è¿˜æ²¡æœ‰é‡åˆ°è¿‡ğŸ˜Šï¼‰</p>
<p>å‡çº§Homebrew:</p>
<pre><code>brew update
</code></pre>
<!-- more -->
<h2 id="å®‰è£…nginx">å®‰è£…nginx</h2>
<p>å…ˆclone nginxé¡¹ç›®åˆ°æœ¬åœ°</p>
<pre><code>brew tap homebrew/nginx
</code></pre>
<p>å®‰è£…</p>
<pre><code>brew install nginx-full --with-rtmp-module

//å¸è½½ï¼š
brew uninstall nginx

</code></pre>
<p>åœ¨ç»ˆç«¯è¾“å…¥ï¼š</p>
<pre><code>nginx
</code></pre>
<p>åœ¨æµè§ˆå™¨é‡Œæ‰“å¼€ <a href="http://localhost:8080">http://localhost:8080</a>,å¦‚æœå‡ºç°ä¸‹å›¾çš„è¡¨ç¤ºå®‰è£…æˆåŠŸäº†</p>
<figure data-type="image" tabindex="2"><img src="http://ww4.sinaimg.cn/large/65e4f1e6gw1f7foiixu87j20fk06amxg.jpg" alt="nginx_success.jpeg" loading="lazy"></figure>
<p>å¦‚æœç»ˆç«¯æç¤ºï¼š</p>
<figure data-type="image" tabindex="3"><img src="http://ww4.sinaimg.cn/large/65e4f1e6gw1f7fomo6p7uj20g702kq3n.jpg" alt="nginx_error.jpg" loading="lazy"></figure>
<p>åˆ™è¡¨ç¤º8080ç«¯å£è¢«å ç”¨äº†, æŸ¥çœ‹ç«¯å£PID</p>
<pre><code>lsof -i tcp:80
</code></pre>
<p>æ ¹æ®ç«¯å£PIDï¼Œkillæ‰ï¼Œç„¶åé‡æ–°æ‰§è¡Œnginxï¼Œæ‰“å¼€ <a href="http://localhost:8080">http://localhost:8080</a></p>
<h2 id="é…ç½®nginxå’Œrtmp">é…ç½®nginxå’Œrtmp</h2>
<p>ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æŸ¥çœ‹nginxå®‰è£…çš„ä½ç½®ï¼š</p>
<pre><code>brew info nginx
</code></pre>
<p>æŸ¥çœ‹nginx.confçš„ä½ç½®<br>
<img src="http://ww2.sinaimg.cn/large/65e4f1e6gw1f7fp6w71yjj20g103t3z3.jpg" alt="location_nginx.jpg" loading="lazy"></p>
<p>ç‚¹å‡»Finder-&gt;å‰å¾€-&gt;å‰å¾€æ–‡ä»¶å¤¹-&gt;è¾“å…¥/usr/local/etc/nginx/nginx.conf-&gt;ç”¨è®°äº‹æœ¬å·¥å…·(æ¨èSublime Text)æ‰“å¼€nginx.confã€‚</p>
<p>åœ¨æ–‡ä»¶æœ€åä¸€è¡Œï¼ŒåŠ å…¥å¦‚ä¸‹é…ç½®ï¼Œä¸è¦åŠ åœ¨<mark>{ }<mark>é‡Œé¢</p>
<pre><code>	
# åœ¨httpèŠ‚ç‚¹åé¢åŠ ä¸Šrtmpé…ç½®ï¼š
rtmp {
    server {
        listen 1935;
        application rtmplive {
            live on;
            record off;
        }
    }
}
	
</code></pre>
<p>å¦‚å›¾ï¼š<br>
<img src="http://ww3.sinaimg.cn/large/65e4f1e6gw1f7fpdsp3xsj20ro0pi0w8.jpg" alt="nginx_conf.jpg" loading="lazy"></p>
<p>ç„¶åé‡å¯nginx</p>
<pre><code>nginx -s reload
</code></pre>
<h2 id="å®‰è£…ffmpeg">å®‰è£…<a href="https://zh.wikipedia.org/zh-hans/FFmpeg">ffmpeg</a></h2>
<p>ffmpegå¯ä»¥ç”¨å…¶ä»–æ–¹å¼å®‰è£…ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯Homebrewå®‰è£…ï¼ˆç®€å•ï¼‰ï¼Œè¾“å…¥å‘½ä»¤</p>
<pre><code>brew install ffmpeg

//å‡çº§å‘½ä»¤:
brew upgrade ffmpeg

//å¦‚æœè¦å¸è½½: 
brew unstall ffmpeg

</code></pre>
<p>å®‰è£…ffmpegæ—¶é—´å¯èƒ½ä¼šé•¿ä¸€ç‚¹ï¼Œ å¦‚æœé€Ÿåº¦è¿‡æ…¢ï¼Œå»ºè®®æ­ä¸ªæ¢¯å­ç¿»è¶Šé•¿åŸ. ä¸è¿‡ä¹Ÿæ‰50å¤šMçš„ä¸œè¥¿ï¼Œ è€å¿ƒä¸€ç‚¹å°±å¥½ã€‚ ç­‰å¾…çš„æ—¶é—´é‡Œ, å†å®‰è£…ä¸€ä¸ªæ”¯æŒrtmpåè®®çš„è§†é¢‘æ’­æ”¾å™¨<a href="http://www.videolan.org/vlc/">VLC</a></p>
<h3 id="1åˆ©ç”¨ffmpegæ¨æµ">1.åˆ©ç”¨ffmpegæ¨æµ</h3>
<p>æˆ‘åœ¨æ¡Œé¢ä¸­æ”¾ä¸€ä¸ªmp4æ ¼å¼çš„æ–‡ä»¶ï¼Œæ‰§è¡Œæ¨æµå‘½ä»¤ï¼š</p>
<pre><code>ffmpeg -re -i /Users/yanfeng/Desktop/ios.mp4 -vcodec libx264 -acodec aac -strict -2 -f flv rtmp://localhost:1935/rtmplive/room

//å¦‚æœæç¤ºæ²¡æœ‰æƒé™æ—¶åŠ å…¥sudoï¼š
sudo ffmpeg -re -i /Users/yanfeng/Desktop/ios.mp4 -vcodec libx264 -acodec aac -strict -2 -f flv rtmp://localhost:1935/rtmplive/room

</code></pre>
<p>å°†è§†é¢‘æ¨æµåˆ°æœ¬åœ°çš„æœåŠ¡å™¨åï¼Œæ‰“å¼€VLCï¼Œç„¶åç‚¹å‡»èœå•File-&gt;Open Network è¾“å…¥ï¼š</p>
<pre><code>rtmp://localhost:1935/rtmplive/room

</code></pre>
<p>è¿™æ ·å°±å¯ä»¥çœ‹åˆ°æ•ˆæœäº†ï¼Œå¦‚å›¾ï¼š</p>
<figure data-type="image" tabindex="4"><img src="http://ww3.sinaimg.cn/large/7853084cjw1fabqzpuetgg20w00k0nph.gif" alt="vlc_play.gif" loading="lazy"></figure>
<ul>
<li>æ¨èä¸€ä¸ªMacä¸‹çš„GIFåˆ¶ä½œå·¥å…·<a href="http://www.gifrocket.com/">gifrocket</a></li>
</ul>
<hr>
<h2 id="åˆ©ç”¨ffmpegè½¬æ¢è§†é¢‘æ ¼å¼">åˆ©ç”¨ffmpegè½¬æ¢è§†é¢‘æ ¼å¼</h2>
<p>åœ¨æ¡Œé¢å‡†å¤‡ä¸€ä¸ªflvæ ¼å¼çš„è§†é¢‘ï¼Œåˆ©ç”¨ffmpegå°†å…¶è½¬æ¢æˆæ ¼å¼ä¸ºmp4çš„è§†é¢‘ï¼Œå¹¶è®¾ç½®å…¶ç ç‡ä¸º640kbpsã€‚åœ¨ç»ˆç«¯è¾“å…¥å‘½ä»¤ï¼š</p>
<pre><code>ffmpeg -i /Users/yanfeng/Desktop/è½¬ç .flv -b:v 640k /Users/yanfeng/Desktop/è½¬ç .mp4

</code></pre>
<p><img src="http://ww2.sinaimg.cn/large/65e4f1e6gw1f7fstz0uh1j20l40fhwk9.jpg" alt="covert_mp4.jpg" loading="lazy"><br>
<img src="http://ww3.sinaimg.cn/large/65e4f1e6gw1f7fsudxa7kj20c806mmx6.jpg" alt="covert_success.jpg" loading="lazy"></p>
<h2 id="markè®°å¾—æŠŠæ–‡ç« ä¸­çš„åœ°å€è·¯å¾„æ¢æˆè‡ªå·±macçš„è·¯å¾„mark"><mark><em><strong>è®°å¾—æŠŠæ–‡ç« ä¸­çš„åœ°å€è·¯å¾„æ¢æˆè‡ªå·±Macçš„è·¯å¾„</strong></em><mark></h2>

            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">ä¸‹ä¸€ç¯‡</div>
            <a href="https://zhengyanfeng.github.io/post/hello-gridea/">
              <h3 class="post-title">
                Hello Gridea
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '602216f311fac9383a87',
    clientSecret: '6284ed4af0af2547c053a4dd8e71a5783b4c3569',
    repo: 'zhengyanfeng.github.io',
    owner: 'zhengyanfeng',
    admin: ['zhengyanfeng'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a> | 
  <a class="rss" href="https://zhengyanfeng.github.io/atom.xml" target="_blank">RSS</a>
</div>

<script>
  hljs.initHighlightingOnLoad()
</script>

      </div>
    </div>
  </body>
</html>
